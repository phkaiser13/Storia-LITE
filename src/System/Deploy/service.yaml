#
# Copyright (C) 2025 Storia-LITE, an open-source software by TruveSoftware
# (a division of Vytruve.org)
# 
# Original Author: Pedro Henrique / phkaiser13
# 
# Description:
#   This Kubernetes Service manifest exposes the StorIA-LITE API Pods as a stable,
#   internal network service. It provides a consistent DNS name and IP address
#   within the cluster, allowing other components (like the Ingress Controller) to
#   reliably connect to the application. The Service uses a selector to find the
#   correct Pods and load-balances incoming traffic among them.
# 
# More information: https://vytruve.org
#
# SPDX-License-Identifier: Apache-2.0
#

apiVersion: v1
kind: Service
metadata:
  # The name of the Service. This name is used by other resources, such as the Ingress,
  # to discover and route traffic to this service.
  name: storia-lite-api-service
  # The namespace where this Service will be created. It must be in the same namespace as the Pods it targets.
  namespace: storia-lite
spec:
  # Specifies the type of service. 'ClusterIP' exposes the service on an internal IP address
  # within the cluster. This is the default type and means the service is not reachable from
  # outside the cluster without an Ingress or other forwarding mechanism.
  type: ClusterIP
  # This selector identifies the set of Pods that will receive traffic from this Service.
  # The labels here MUST match the labels defined in the Pod template of the 'storia-lite-api-deployment'.
  selector:
    app: storia-lite-api
  ports:
    - protocol: TCP # The network protocol for this port. TCP is standard for HTTP/S traffic.
      # The port on which the Service itself is exposed within the cluster.
      # The Ingress Controller will send traffic to this port.
      port: 80
      # The port on the target Pods (containers) to which traffic will be forwarded.
      # This must match the 'containerPort' specified in the Deployment manifest (04-deployment.yaml).
      targetPort: 8080